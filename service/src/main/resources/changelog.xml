<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog 
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">
    <changeSet author="SunHan" id="15862614903-001">
        <createTable tableName="sys_office">
            <column autoIncrement="true" name="id" type="MEDIUMINT(8) UNSIGNED">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" remarks="部门名称" type="VARCHAR(30)">
                <constraints nullable="false"/>
            </column>
            <column name="parent_id" remarks="父部门" type="CHAR(32)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-002">
        <addColumn tableName="sys_user">
            <column name="office_id" remarks="部门Id" type="VARCHAR(30)"/>
        </addColumn>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-003">
        <sql>
            ALTER TABLE `sys_role`
            CHANGE COLUMN `status` `del_flag` INT(3) NOT NULL DEFAULT '1' COMMENT '是否删除' ;
        </sql>
    </changeSet>

    <changeSet id="James" author="18964317375-001">
        <addColumn tableName="sys_user">
            <column name="open_id" remarks="openId" type="VARCHAR(200)">
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-004">
        <sql>
            ALTER TABLE `sys_menu` CHANGE COLUMN `status` `del_flag` int(3) NOT NULL DEFAULT 1;
        </sql>
    </changeSet>

    <changeSet author="SunHan" id="15862614903-005">
        <sql>
            ALTER TABLE `sys_button` CHANGE COLUMN `status` `del_flag` int(3) NOT NULL DEFAULT 1;
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-006">
        <sql>
            ALTER TABLE `sys_user` DROP COLUMN `del_flag`, CHANGE COLUMN `status` `del_flag` varchar(32) DEFAULT NULL
            COMMENT '状态';
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-007">
        <sql>
            ALTER TABLE `sys_dict` CHANGE COLUMN `del_flag` `del_flag` int(3) NOT NULL DEFAULT '0' COMMENT '删除标记';
            ALTER TABLE `sys_user` CHANGE COLUMN `last_login` `last_login` datetime DEFAULT NULL COMMENT '上次登录时间';
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-008">
        <sql>
            ALTER TABLE `sys_dict` DROP COLUMN `id`,drop PRIMARY KEY;

            ALTER TABLE `sys_dict` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-009">
        <sql>
            ALTER TABLE `sys_user` DROP COLUMN `skin`
        </sql>
    </changeSet>

    <changeSet author="SunHan" id="15862614903-010">
        <sql dbms="mysql">
            ALTER TABLE `sys_user` CHANGE COLUMN `user_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY, ADD
            PRIMARY KEY (`id`);
            ALTER TABLE `sys_button` CHANGE COLUMN `button_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY,
            ADD PRIMARY KEY (`id`);
            ALTER TABLE `sys_menu` CHANGE COLUMN `menu_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY, ADD
            PRIMARY KEY (`id`);
            ALTER TABLE `sys_role` CHANGE COLUMN `role_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY, ADD
            PRIMARY KEY (`id`);
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-011">
        <sql>
            drop table dd_collect;
            ALTER TABLE `dd_consumer` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_consumer` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_message` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_message` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_report` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_report` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_works` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_works` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_works_level` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_works_level` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-012">
        <sql>
            ALTER TABLE `dd_works_level` ADD COLUMN `is_draft` int(2) NOT NULL DEFAULT 0;
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-013">
        <sql>
            ALTER TABLE `dd_works_level` DROP COLUMN `jingdu`;
            ALTER TABLE `dd_works_level` ADD COLUMN `chunjingdu` varchar(64) DEFAULT NULL COMMENT '纯净度';
        </sql>
    </changeSet>


</databaseChangeLog>