<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog 
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">
    <changeSet author="SunHan" id="15862614903-001">
        <createTable tableName="sys_office">
            <column autoIncrement="true" name="id" type="MEDIUMINT(8) UNSIGNED">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" remarks="部门名称" type="VARCHAR(30)">
                <constraints nullable="false"/>
            </column>
            <column name="parent_id" remarks="父部门" type="CHAR(32)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-002">
        <addColumn tableName="sys_user">
            <column name="office_id" remarks="部门Id" type="VARCHAR(30)"/>
        </addColumn>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-003">
        <sql>
            ALTER TABLE `sys_role`
            CHANGE COLUMN `status` `del_flag` INT(3) NOT NULL DEFAULT '1' COMMENT '是否删除' ;
        </sql>
    </changeSet>

    <changeSet id="James" author="18964317375-001">
        <addColumn tableName="sys_user">
            <column name="open_id" remarks="openId" type="VARCHAR(200)">
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-004">
        <sql>
            ALTER TABLE `sys_menu` CHANGE COLUMN `status` `del_flag` int(3) NOT NULL DEFAULT 1;
        </sql>
    </changeSet>

    <changeSet author="SunHan" id="15862614903-005">
        <sql>
            ALTER TABLE `sys_button` CHANGE COLUMN `status` `del_flag` int(3) NOT NULL DEFAULT 1;
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-006">
        <sql>
            ALTER TABLE `sys_user` DROP COLUMN `del_flag`, CHANGE COLUMN `status` `del_flag` varchar(32) DEFAULT NULL
            COMMENT '状态';
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-007">
        <sql>
            ALTER TABLE `sys_dict` CHANGE COLUMN `del_flag` `del_flag` int(3) NOT NULL DEFAULT '0' COMMENT '删除标记';
            ALTER TABLE `sys_user` CHANGE COLUMN `last_login` `last_login` datetime DEFAULT NULL COMMENT '上次登录时间';
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-008">
        <sql>
            ALTER TABLE `sys_dict` DROP COLUMN `id`,drop PRIMARY KEY;

            ALTER TABLE `sys_dict` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-009">
        <sql>
            ALTER TABLE `sys_user` DROP COLUMN `skin`
        </sql>
    </changeSet>

    <changeSet author="SunHan" id="15862614903-010">
        <sql dbms="mysql">
            ALTER TABLE `sys_user` CHANGE COLUMN `user_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY, ADD
            PRIMARY KEY (`id`);
            ALTER TABLE `sys_button` CHANGE COLUMN `button_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY,
            ADD PRIMARY KEY (`id`);
            ALTER TABLE `sys_menu` CHANGE COLUMN `menu_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY, ADD
            PRIMARY KEY (`id`);
            ALTER TABLE `sys_role` CHANGE COLUMN `role_id` `id` int(11) NOT NULL AUTO_INCREMENT, DROP PRIMARY KEY, ADD
            PRIMARY KEY (`id`);
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-011">
        <sql>
            drop table dd_collect;
            ALTER TABLE `dd_consumer` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_consumer` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_message` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_message` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_report` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_report` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_works` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_works` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
            ALTER TABLE `dd_works_level` DROP COLUMN `id`,drop PRIMARY KEY;
            ALTER TABLE `dd_works_level` ADD COLUMN `id` int(11) NOT NULL AUTO_INCREMENT FIRST, ADD PRIMARY KEY (`id`);
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-012">
        <sql>
            ALTER TABLE `dd_works_level` ADD COLUMN `is_draft` int(2) NOT NULL DEFAULT 0;
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-013">
        <sql>
            ALTER TABLE `dd_works_level` DROP COLUMN `jingdu`;
            ALTER TABLE `dd_works_level` ADD COLUMN `chunjingdu` varchar(64) DEFAULT NULL COMMENT '纯净度';
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-014">
        <sql>
            ALTER TABLE `dd_works` DROP COLUMN `create_by`;
            ALTER TABLE `dd_works` ADD COLUMN `create_by` int(11) DEFAULT NULL COMMENT '创建者';
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-015">
        <sql>
            ALTER TABLE `sys_user` CHANGE COLUMN `score` `score` int(11) DEFAULT 0 COMMENT '积分';
            ALTER TABLE `sys_score_calc` CHANGE COLUMN `value` `value` int(11) DEFAULT NULL;
            ALTER TABLE `dd_score_history` CHANGE COLUMN `value` `value` int(11) DEFAULT NULL COMMENT '加减积分';
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-016">
        <sql>
            ALTER TABLE `dd_consumer` ADD COLUMN `works_id` int(11) DEFAULT NULL COMMENT '作品id';
            ALTER TABLE `dd_consumer` ADD COLUMN `is_draft` int(2) DEFAULT NULL COMMENT '是否是草稿';
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-017">
        <sql>
            ALTER TABLE `dd_works` DROP COLUMN `size`;
            ALTER TABLE `dd_works` ADD COLUMN `length` decimal(11,2) DEFAULT NULL COMMENT '长度';
            ALTER TABLE `dd_works` ADD COLUMN `width` decimal(11,2) DEFAULT NULL COMMENT '宽度';
            ALTER TABLE `dd_works` ADD COLUMN `height` decimal(11,2) DEFAULT NULL COMMENT '高度';
            ALTER TABLE `dd_works` ADD COLUMN `weight` decimal(11,2) DEFAULT NULL COMMENT '重量';
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-012">
        <sql>
            CREATE TABLE `dd_images` (
            `id` int NOT NULL AUTO_INCREMENT,
            `target_id` int COMMENT '目标Id，根据type来判断哪张表的主键',
            `url` varchar(200) COMMENT '图片相对路径',
            `type` varchar(10) COMMENT '图片类型',
            PRIMARY KEY (`id`)
            ) COMMENT='';
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-018">
        <sql>
            ALTER TABLE `sys_user` DROP COLUMN `follow_count`;
        </sql>
    </changeSet>

    <changeSet author="SunZhongYang" id="15606137056-001">
        <sql>
            ALTER TABLE `dd_consumer` DROP COLUMN `create_by`;
            ALTER TABLE `dd_consumer` DROP COLUMN `update_by`;
            ALTER TABLE `dd_consumer` ADD COLUMN `create_by` int(11) DEFAULT NULL COMMENT '创建者';
            ALTER TABLE `dd_consumer` ADD COLUMN `update_by` int(11) DEFAULT NULL COMMENT '更新者';
        </sql>
    </changeSet>

    <changeSet author="SunZhongYang" id="15606137056-002">
        <sql>
            ALTER TABLE `dd_value_report` ADD COLUMN `zpxx_imge` varchar(256) DEFAULT NULL COMMENT '作品详细评估报告图片';
            ALTER TABLE `dd_value_report` ADD COLUMN `jzrz_imge` varchar(256) DEFAULT NULL COMMENT '作品价值认证图片';
        </sql>
    </changeSet>

    <changeSet author="SunZhongYang" id="15606137056-003">
        <sql>
            ALTER TABLE `dd_value_report` ADD COLUMN `jzyxsj` date DEFAULT NULL COMMENT '价值认证时间';
        </sql>
    </changeSet>

    <changeSet author="WangShun" id="15950097942-019">
        <sql>
            ALTER TABLE `dd_works_level` CHANGE COLUMN `works_id` `works_id` int(11) DEFAULT NULL COMMENT '作品id';
        </sql>
    </changeSet>

    <changeSet author="SunHan" id="15862614903-013">
        <sql dbms="mysql">
            ALTER TABLE `sys_dict` DROP COLUMN `create_by`, DROP COLUMN `create_date`, DROP COLUMN
            `update_by`, DROP COLUMN `update_date`;
        </sql>
    </changeSet>
    <changeSet author="SunHan" id="15862614903-014">
        <sql dbms="mysql">
            ALTER TABLE `dd_report` CHANGE COLUMN `works_id` `works_id` int(11) DEFAULT NULL COMMENT '作品Id';
        </sql>
    </changeSet>

    <changeSet author="WangShun" id="15950097942-021">
        <sql>
            ALTER TABLE `sys_user` DROP COLUMN `perfer`;
            ALTER TABLE `sys_user` ADD COLUMN `prefer` varchar(64) DEFAULT NULL COMMENT '偏好';
            ALTER TABLE `sys_user` ADD COLUMN `address` varchar(64) DEFAULT NULL COMMENT '地址';
        </sql>
    </changeSet>
    <changeSet author="WangShun" id="15950097942-022">
        <sql>
            ALTER TABLE `sys_user` ADD COLUMN `head_img_url` varchar(200) DEFAULT NULL COMMENT '头像图片地址';
        </sql>
    </changeSet>


</databaseChangeLog>